import{j as e,r as o}from"./index-YfVBpsc2.js";function T({topic:n,isOpen:c,onToggle:l,onCheck:d,checked:u,isAnswered:x}){const m=e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"size-6 stroke-green-600",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})});return e.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[e.jsxs("div",{onClick:l,className:"bg-gray-100 p-4 cursor-pointer flex justify-between items-center",children:[e.jsx("h2",{className:"font-semibold text-lg",children:n.ShortTitle}),e.jsx("p",{children:x(n)?m:""})]}),c&&e.jsx("div",{className:"p-4 bg-white",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:n.Title}),e.jsx("p",{className:"text-gray-600 italic",children:n.ShortTitle})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Stances:"}),(n.stances||[]).map((t,h)=>{var i;return e.jsx("label",{children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("input",{type:"radio",name:n.ShortTitle,value:t.Value,checked:((i=u[n.ID])==null?void 0:i.answer)==t.Value,onChange:()=>d(n,t.Value)}),e.jsxs("p",{className:"mb-1",children:[t.Value,". ",t.Text]},h)]})},t.Value)})]})]})})]})}function I({topics:n}){const[c,l]=o.useState(null),[d,u]=o.useState({}),[x,m]=o.useState([]),[t,h]=o.useState({}),[i,f]=o.useState(!1),[p,j]=o.useState("");o.useEffect(()=>{if(c){const s=setTimeout(()=>l(null),1e4);return()=>clearTimeout(s)}},[c]);const w=s=>{j(s.target.value)},b=n.filter(s=>s.ShortTitle.toLowerCase().includes(p.toLowerCase())),g=(s,r)=>{u(a=>({...a,[s]:r}))},N=s=>{m(r=>r.includes(s)?r.filter(a=>a!==s):[...r,s])},y=()=>{f(!i)},v=(s,r)=>{h(a=>({...a,[s.ID]:{answer:r}})),console.log("Checked: ",t)},k=s=>s.ID in t,C=()=>Object.entries(t).map(([s,r])=>({topic_id:s,value:r.answer})),S=async()=>{try{const s=await fetch("https://ev-backend-edhm.onrender.com/auth/create-dummy",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:d.username})});if(!s.ok){const a=await s.text();console.error("Failed to create dummy user:",a),l("error");return}const r=await fetch("https://ev-backend-edhm.onrender.com/compass/answers/dummy",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:d.username,answers:C()})});if(!r.ok){const a=await r.text();console.error("Failed to add dummy answers:",a),l("error");return}console.log("Dummy user and answers created successfully!"),l("success"),u({}),h({}),m([]),f(!1),j("")}catch(s){console.error("Unexpected error:",s),l("error")}};return e.jsx("div",{className:"w-full md:w-3/4 mx-auto mt-6 space-y-4",children:e.jsxs("div",{className:"mx-6 mt-6 border p-4 rounded-xl",children:[e.jsx("h1",{className:"text-2xl font-semibold text-center",children:"Create a dummy user"}),c==="success"&&e.jsx("div",{className:"text-green-700 text-center font-medium mt-2",children:"✅ Dummy user created successfully!"}),c==="error"&&e.jsx("div",{className:"text-red-600 text-center font-medium mt-2",children:"❌ Failed to create dummy user. Please try again."}),e.jsxs("div",{className:"w-full md:w-3/4 m-auto mt-6 flex gap-4 p-4 rounded-xl",children:[e.jsx("h1",{className:"block text-xl font-semibold",children:"Username:"}),e.jsx("input",{className:"border rounded p-1 w-1/2 bg-white",value:d.username,onChange:s=>g("username",s.target.value)})]}),e.jsxs("div",{className:"w-full md:w-3/4 m-auto mt-6 flex flex-col gap-4 bg-neutral-50 border border-neutral-200 p-4 rounded-xl cursor-pointer",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("h1",{className:"block text-xl font-semibold",children:"Add Answers:"}),e.jsx("button",{className:"cursor-pointer underline",onClick:y,children:i?"Close":"Open"})]}),e.jsxs("div",{className:`${i?"block":"hidden"} flex flex-col gap-4`,children:[e.jsx("input",{id:"search",className:"border rounded p-2 w-full bg-white",value:p,placeholder:"Search...",onChange:s=>w(s)}),b.map(s=>e.jsx(T,{topic:s,isOpen:x.includes(s.ID),onToggle:()=>N(s.ID),onCheck:v,checked:t,isAnswered:k},s.ID))]})]}),e.jsx("div",{className:"flex justify-center gap-2 mt-6",children:e.jsx("button",{disabled:!d.username,onClick:S,className:"px-4 py-2 bg-black text-white rounded disabled:opacity-50 cursor-pointer disabled:cursor-not-allowed",children:"Create"})})]})})}export{I as default};
